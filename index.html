<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <title>Dern-Market — Zamonaviy E-commerce platforma</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#111827" />
  <link href="/styles.css" rel="stylesheet" />

  <link rel="preconnect" href="https://www.zohowebstatic.com" crossorigin />
  <link
          rel="preload"
          as="image"
          href="https://www.zohowebstatic.com/sites/zweb/images/commerce/build-beautiful-store-banner.png"
          imagesrcset="https://www.zohowebstatic.com/sites/zweb/images/commerce/build-beautiful-store-banner.png 1x"
          imagesizes="(max-width: 920px) 100vw, 40vw"
  />

  <style>
    body {
      background:
              radial-gradient(1200px 600px at -10% -10%, #eef2ff 0%, transparent 50%),
              radial-gradient(1200px 600px at 110% -10%, #fef9c3 0%, transparent 50%);
    }
    .page-wrap { padding-top: 56px; padding-bottom: 56px; }

    /* Simple top brand bar */
    .brandbar {
      position: sticky; top: 0; z-index: 20;
      display: flex; align-items: center; gap: 10px;
      height: 56px; padding: 0 16px;
      background: rgba(255,255,255,.86); backdrop-filter: blur(6px);
      border-bottom: 1px solid var(--border);
    }
    .brand-logo {
      width: 28px; height: 28px; border-radius: 8px;
      background: linear-gradient(135deg, #111827 0%, #374151 100%);
    }
    .brandbar h1 { font-size: 16px; margin: 0; }
    .brandbar .actions { margin-left: auto; display: flex; gap: 8px; }

    /* Top progress bar (indeterminate) */
    .progress {
      position: fixed; inset: 0 0 auto 0; height: 3px; z-index: 30;
      background: linear-gradient(90deg, #111827, #6b7280);
      transform-origin: 0 50%;
      animation: progress 1.2s linear infinite;
      display: none;
    }
    .progress.show { display: block; }
    @keyframes progress {
      0% { transform: translateX(-100%) scaleX(0.2); }
      50% { transform: translateX(0%) scaleX(0.6); }
      100% { transform: translateX(100%) scaleX(0.2); }
    }

    /* Hero */
    .hero {
      display: grid; gap: 24px; align-items: center; grid-template-columns: 1.2fr 1fr;
      background: linear-gradient(135deg, #f9fbff 0%, #f3f6ff 100%);
      border: 1px solid var(--border); border-radius: 16px; overflow: hidden;
      box-shadow: 0 10px 30px rgba(17, 24, 39, 0.06);
    }
    .hero-content { padding: 28px; }
    .badge {
      display: inline-flex; align-items: center; gap: 8px; font-weight: 600; font-size: 12px;
      color: #0f172a; background: #e6f4ff; border: 1px solid #dbeafe; padding: 6px 10px; border-radius: 999px;
    }
    .title-xl { font-size: 38px; line-height: 1.2; letter-spacing: -0.3px; margin: 10px 0 0; }
    .subtitle { margin-top: 10px; font-size: 16px; color: #4b5563; }

    .chips { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 16px; }
    .chip {
      border: 1px solid var(--border); border-radius: 999px; padding: 8px 14px; background: #fff;
      font-size: 13px; color: #111827; box-shadow: 0 1px 0 rgba(17,24,39,.04);
    }

    .cta-row { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 22px; }

    /* Image side with skeleton */
    .image-wrap {
      position: relative; min-height: 320px;
      background: linear-gradient(180deg, #eef2ff, #f8fafc);
    }
    .img-skel {
      position: absolute; inset: 0; border-left: 1px solid var(--border);
      background:
              linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,.7) 50%, rgba(255,255,255,0) 100%),
              linear-gradient(180deg, #eef2ff, #f8fafc);
      background-size: 200% 100%, 100% 100%;
      animation: shimmer 1.2s linear infinite;
    }
    @keyframes shimmer { 0% { background-position: -200% 0, 0 0; } 100% { background-position: 200% 0, 0 0; } }
    .hero-img {
      width: 100%; height: 100%; display: block; object-fit: cover; opacity: 0; transition: opacity .3s ease;
    }
    .image-wrap.loaded .img-skel { display: none; }
    .image-wrap.loaded .hero-img { opacity: 1; }

    /* Features */
    .features { margin-top: 28px; }
    .features-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    .features .card h3 { margin: 0 0 6px; }
    .features .card p { margin: 0; }

    /* Loader overlay for auth redirect */
    .loader-overlay {
      position: fixed; inset: 0; display: none; place-items: center;
      background: rgba(255,255,255,.85); backdrop-filter: blur(4px); z-index: 9999;
    }
    .loader-card {
      background: #fff; border: 1px solid var(--border); border-radius: 14px; padding: 16px 18px;
      box-shadow: 0 10px 30px rgba(17,24,39,.10); display: flex; align-items: center; gap: 12px;
    }
    .spinner {
      width: 22px; height: 22px; border: 3px solid #e5e7eb; border-top-color: #111827; border-radius: 999px;
      animation: spin .9s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Responsive */
    @media (max-width: 920px) {
      .hero { grid-template-columns: 1fr; }
      .title-xl { font-size: 30px; }
      .features-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
<!--Indeterminate progress bar (shown briefly on first load and during redirects)-->
<div id="progress" class="progress" aria-hidden="true"></div>

<!--Sticky brand bar-->
<header class="brandbar" role="banner">
  <div class="brand-logo" aria-hidden="true"></div>
  <h1>Dern‑Market</h1>
  <div class="actions">
    <a class="btn pill" href="../front-end/products.html">Katalog</a>
    <a class="btn outline pill" href="../front-end/register.html">Ro‘yxatdan o‘tish</a>
    <a class="btn primary pill" href="../front-end/login.html">Kirish</a>
  </div>
</header>

<!--Loader: shows only if user token exists and we redirect-->
<div id="loader" class="loader-overlay" aria-live="polite" aria-busy="true">
  <div class="loader-card">
    <div class="spinner" aria-hidden="true"></div>
    <div id="loader-text" class="small">Yo‘naltirilmoqda... Iltimos, kuting.</div>
  </div>
</div>

<main class="center page-wrap">
  <div class="card" style="max-width: 1100px; padding: 0; background: transparent; border: none; box-shadow:none">
    <section class="hero">
      <div class="hero-content">
        <span class="badge">Yangi platforma • Ishonchli e‑commerce</span>
        <h2 class="title-xl">Savdo jarayonlarini raqamlashtiruvchi platforma</h2>
        <p class="subtitle">
          Dern‑Market kompaniyalarga mahsulotlar savdosini raqamlashtirish, foydalanuvchilar bilan aloqani kuchaytirish
          va buyurtma jarayonini soddalashtirishga yordam beradi.
        </p>

        <div class="chips" aria-label="Asosiy imkoniyatlar">
          <span class="chip">Mahsulotlarni qidirish</span>
          <span class="chip">Savatcha va buyurtma</span>
          <span class="chip">Xavfsiz to‘lov</span>
          <span class="chip">Holatni kuzatish</span>
          <span class="chip">FAQ va yordam</span>
          <span class="chip">Admin boshqaruvi</span>
          <span class="chip">Analitika va hisobotlar</span>
        </div>

        <div class="cta-row">
          <a class="btn primary lg pill" href="../front-end/login.html">Kirish</a>
          <a class="btn outline lg pill" href="../front-end/register.html">Ro‘yxatdan o‘tish</a>
          <a class="btn ghost lg pill" href="../front-end/products.html">Katalogni ko‘rish</a>
        </div>
      </div>

      <div id="imageWrap" class="image-wrap" aria-hidden="true">
        <div class="img-skel"></div>
        <img
                id="heroImg"
                class="hero-img"
                src="https://www.zohowebstatic.com/sites/zweb/images/commerce/build-beautiful-store-banner.png"
                alt="Dern‑Market — onlayn do‘kon bannneri va mahsulot vitrinasi"
                loading="eager"
                decoding="async"
        />
      </div>
    </section>

    <section class="features" aria-label="Afzalliklar">
      <div class="features-grid">
        <div class="card">
          <h3>Tezkor qidiruv</h3>
          <p class="muted small">Mahsulotlarni nomi, toifasi yoki tavsifi bo‘yicha qulay toping.</p>
        </div>
        <div class="card">
          <h3>Xavfsiz to‘lov</h3>
          <p class="muted small">Buyurtmalar uchun ishonchli va xavfsiz to‘lov jarayonlari.</p>
        </div>
        <div class="card">
          <h3>Real vaqt kuzatuv</h3>
          <p class="muted small">Buyurtmangiz holatini real vaqt rejimida kuzating.</p>
        </div>
      </div>
    </section>
  </div>
</main>

<script>
  // Utilities
  const TOKEN_KEY = 'dm_token', USER_KEY = 'dm_user'
  function getUser() {
    try {
      const raw = localStorage.getItem(USER_KEY)
      return raw ? JSON.parse(raw) : null
    } catch { return null }
  }

  // Show a subtle progress bar on first paint, hide after a short delay
  const progress = document.getElementById('progress')
  if (progress) {
    progress.classList.add('show')
    window.addEventListener('load', () => {
      setTimeout(() => progress.classList.remove('show'), 350)
    })
  }

  // Hero splash image: skeleton until loaded, graceful fallback
  (function handleHeroImage() {
    const wrap = document.getElementById('imageWrap')
    const img = document.getElementById('heroImg')
    if (!wrap || !img) return

    // If cached and already complete, mark as loaded immediately
    if (img.complete && img.naturalWidth > 0) {
      wrap.classList.add('loaded')
      return
    }

    img.addEventListener('load', () => {
      wrap.classList.add('loaded')
    })

    img.addEventListener('error', () => {
      // Fallback to local image if remote fails
      img.src = '/modern-tech-product.png'
    })
  })()

  // If authenticated, show loader overlay and auto-redirect based on role
  document.addEventListener('DOMContentLoaded', () => {
    const token = localStorage.getItem(TOKEN_KEY)
    const user = getUser()
    if (!token || !user) return

    const loader = document.getElementById('loader')
    const loaderText = document.getElementById('loader-text')
    const role = user.role === 'admin' ? 'admin' : 'user'
    const dashHref = role === 'admin' ? '../front-end/admin-dashboard.html' : '../front-end/user-dashboard.html'

    if (loader) {
      loader.style.display = 'grid'
      if (loaderText) {
        loaderText.textContent =
                role === 'admin'
                        ? 'Admin dashboardga yo‘naltirilmoqda...'
                        : 'Foydalanuvchi dashboardga yo‘naltirilmoqda...'
      }
    }
    if (progress) progress.classList.add('show')

    // Small delay to render loader smoothly, then redirect
    setTimeout(() => {
      location.href = (dashHref)
    }, 350)
  })
</script>
</body>
</html>
